<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Anddd7"><title>数据分析 起步 (一) MongoDB+Hadoop · Anddd7's Planet</title><meta name="description" content="上个月看到一个学长在做斗鱼弹幕分析的开源项目 ,正好之前的计划已经完成了大半 ,所以决定借此机会学习一波爬虫和数据分析. 后面学长忙其他事去了 ,我也就开了一个新坑 ,从抓取分析B站的数据开始 :）
项目地址:bilibili-analysis-data
准备爬虫说到爬虫 ,就会想到Python ,"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/assets/avatar.jpeg" style="width:127px;"><h3 title=""><a href="/">Anddd7's Planet</a></h3><div class="description"><p>Level Up! Programmer~</p></div></div></div><ul class="social-links"><li><a href="http://github.com/Anddd7"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Nice Theme of </span></a><a href="https://github.com/Ben02/hexo-theme-Anatole">Anatole</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li><a href="/about">关于</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/assets/avatar.jpeg"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>数据分析 起步 (一) MongoDB+Hadoop</a></h3></div><div class="post-content"><p>上个月看到一个学长在做斗鱼弹幕分析的开源项目 ,正好之前的计划已经完成了大半 ,所以决定借此机会学习一波爬虫和数据分析. 后面学长忙其他事去了 ,我也就开了一个新坑 ,从抓取分析B站的数据开始 :）</p>
<p>项目地址:<a href="https://github.com/Anddd7/bilibili-analysis-data" target="_blank" rel="noopener">bilibili-analysis-data</a></p>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h3 id="爬虫"><a href="#爬虫" class="headerlink" title="爬虫"></a>爬虫</h3><p>说到爬虫 ,就会想到Python ,边学边写我就直接上手了 .因为之前有接触过scala ,最近工作中也会写很多js (前端还很菜) ,所以语法掌握起来还不算太难 .不过我也没有一开始就写爬虫 ,先写了一个上传文件到FTP的脚本 ,用来上传我工作中的一些文件.</p>
<blockquote>
</blockquote>
<p>主要是练手 ,所以使用python成功抓取数据并放入DB后 ,还是用Java重构了那部分代码 ,准备后期做自动化程序</p>
<h5 id="完成程序"><a href="#完成程序" class="headerlink" title="完成程序"></a>完成程序</h5><p><li>Python <br></li></p>
<p><ul>- 上传文件到FTP</ul></p>
<ul>
<li>爬取<a href="http://linux.linuxidc.com/" target="_blank" rel="noopener">Linux公社</a>的技术书籍</li>
<li>抓取bilibili视频数据 (开始抓的页面 ,后来发现了几个api接口 ,直接返回的JSON)- 使用<a href="https://github.com/code4craft/webmagic" target="_blank" rel="noopener">webmagic</a>抓取房天下的房屋数据 (代码已删除)</li>
<li>抓取bilibili接口数据<blockquote>
</blockquote>
Python的第三方功能非常完善和强大 ,也有脚本语言简洁/直接的特点 ,用起来还是很不错的 .<br>在最近的工作中 ,我用Python生成带版本号的js文件 ,扫描并替换html中的script和css相对地址 ,实现前端文件的版本系统.</li>
</ul>
<h3 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h3><p>中间对数据分析部分的技术选型犹豫了一阵 ,开始想使用mysql ,使用ORM框架 ,然后就可以操作POJO类进行后面的处理 .</p>
<p>但是关系型数据库对形态不固定的数据支持度很低 (抓取的数据五花八门 ,就算通过接口抓 ,也要建表建字段 ,心累)</p>
<p>所以果断使用了MongoDB ,抓取的数据直接insert进去就行 ,不用管字段的数量和类型.</p>
<p>建议用IDEA的朋友安装<a href="https://plugins.jetbrains.com/plugin/7141-mongo-plugin" target="_blank" rel="noopener">Mongo Plugin</a> ,启动mongod.exe后就可以在IDEA中查看数据了.</p>
<p><img alt="这里写图片描述" src="http://img.blog.csdn.net/20170928142941455?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMTg1ODQwNQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" title=""></p>
<h3 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h3><p>(大)数据分析 ,自然少不了Hadoop/Spark等 ,Java环境下自然首选Hadoop .学习的话最好搭建一个开发环境 ,不然每次都要把数据传到服务器上也是很麻烦的一件事 .</p>
<p><a href="http://blog.csdn.net/antgan/article/details/52067441" target="_blank" rel="noopener">教你Windows平台安装配置Hadoop</a>选用Hadoop 2.7.4 + <a href="https://github.com/sardetushar/hadooponwindows" target="_blank" rel="noopener">hadooponwindows</a> 就可以在Windows上单机运行Hadoop程序了 .</p>
<h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><blockquote>
</blockquote>
<p></p><p>自我提醒: <br><br>   在搭建这个项目的时候 ,我就想要构造一个灵活的系统/要抽取/要继承/要抽象 ,反而把代码弄得很乱 ,结构很散 . </p><br>在工作的时候(目前由我独立开发) ,因为有很强的目的性 ,我会优先完成功能 ,然后再考虑功能是否重复/可否抽象 .<p></p>
<h3 id="TaskManager任务管理器"><a href="#TaskManager任务管理器" class="headerlink" title="TaskManager任务管理器"></a>TaskManager任务管理器</h3><p>分发任务</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="literal">void</span> router(<span class="built_in">String</span> module, <span class="built_in">String</span> taskName, <span class="built_in">List</span>&lt;Object&gt; <span class="keyword">params</span>) &#123;</span><br><span class="line">        switch (module) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"crawler"</span>:</span><br><span class="line">                routerCrawler(taskName, <span class="keyword">params</span>);</span><br><span class="line">                break;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">"analysis"</span>:</span><br><span class="line">                routerAnalysis(taskName, <span class="keyword">params</span>);</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="literal">void</span> routerCrawler(<span class="built_in">String</span> taskName, <span class="built_in">List</span>&lt;Object&gt; <span class="keyword">params</span>) &#123;</span><br><span class="line">      <span class="params">...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="literal">void</span> routerAnalysis(<span class="built_in">String</span> taskName, <span class="built_in">List</span>&lt;Object&gt; <span class="keyword">params</span>) &#123;</span><br><span class="line">      <span class="params">...</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>执行任务并记录任务的状态</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">public <span class="literal">void</span> execute(String <span class="built_in">module</span>, String taskName, List&lt;Object&gt; params) &#123;</span><br><span class="line">        BasicDBObject searchQuery = <span class="keyword">new</span> BasicDBObject()</span><br><span class="line">                .append(<span class="string">"module"</span>, <span class="built_in">module</span>)</span><br><span class="line">                .append(<span class="string">"taskName"</span>, taskName)</span><br><span class="line">                .append(<span class="string">"params"</span>, params);</span><br><span class="line"></span><br><span class="line">        log.debug(<span class="string">"开始执行任务:\n&#123;&#125;"</span>, searchQuery.toString());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> (MongoCursor&lt;Document&gt; result = MongodbDao.find(TASK_RECORD, searchQuery)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (result.hasNext()) &#123;</span><br><span class="line">                Document taskRecord = result.next();</span><br><span class="line"></span><br><span class="line">                log.debug(<span class="string">"查询到任务历史记录:\n&#123;&#125;"</span>, taskRecord.toString());</span><br><span class="line"></span><br><span class="line">                TaskStatusEnum taskStatus = TaskStatusEnum.valueOf(taskRecord.getString(<span class="string">"taskStatus"</span>));</span><br><span class="line">                <span class="keyword">if</span> (taskStatus.equals(running)) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> KnownException(taskRecord.toString() + <span class="string">"任务正在执行中 ,请勿重复执行"</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (taskStatus.equals(TaskStatusEnum.finished)) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> KnownException(taskRecord.toString() + <span class="string">"任务已执行完毕 ,请到结果页面进行查看"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Instant start = now();</span><br><span class="line">        searchQuery.append(<span class="string">"taskStatus"</span>, running);</span><br><span class="line">        searchQuery.append(<span class="string">"startTime"</span>, start);</span><br><span class="line">        MongodbDao.insert(TASK_RECORD, searchQuery);</span><br><span class="line"></span><br><span class="line">        executorService.execute<span class="function"><span class="params">(() -&gt; &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">            TaskStatusEnum endStatus = finished;</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">try</span> &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">                router(<span class="built_in">module</span>, taskName, params);</span></span></span><br><span class="line"><span class="function"><span class="params">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">                endStatus = stop;</span></span></span><br><span class="line"><span class="function"><span class="params">                log.error(<span class="string">"&#123;&#125;任务执行异常中止"</span>, String.join(<span class="built_in">module</span>, taskName), e);</span></span></span><br><span class="line"><span class="function"><span class="params">            &#125;</span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">            log.debug(<span class="string">"&#123;&#125;任务执行完毕: &#123;&#125; ms"</span>, String.join(<span class="built_in">module</span>, taskName), Duration.between(start, now()).toMillis());</span></span></span><br><span class="line"><span class="function"><span class="params">            MongodbDao.update(TASK_RECORD, searchQuery,</span></span></span><br><span class="line"><span class="function"><span class="params">                    <span class="keyword">new</span> BasicDBObject()</span></span></span><br><span class="line"><span class="function"><span class="params">                            .append(<span class="string">"$set"</span>, <span class="keyword">new</span> BasicDBObject()</span></span></span><br><span class="line"><span class="function"><span class="params">                                    .append(<span class="string">"taskStatus"</span>, endStatus)</span></span></span><br><span class="line"><span class="function"><span class="params">                                    .append(<span class="string">"endTime"</span>, now())));</span></span></span><br><span class="line"><span class="function"><span class="params">        &#125;)</span>;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br></pre></td></tr></table></figure>
<p>任务管理器是单例的 ,并运行在主线程 ,因此能够保证execute方法是线程安全的 ; 确定执行的任务由子线程执行 ,并且将状态保存在DB中 ,可以随时检查执行状态.</p>
<h3 id="Crawler抓取"><a href="#Crawler抓取" class="headerlink" title="Crawler抓取"></a>Crawler抓取</h3><p>多种渠道抓取数据 (这里是使用的bilibili开放的一个search接口)</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">public <span class="literal">void</span> search(int year, int month) &#123;</span><br><span class="line">        String out = source_search.table(getYYYYMM(year, month));</span><br><span class="line">        MongodbDao.drop(out);</span><br><span class="line"></span><br><span class="line">        ExecutorService fixedThreadPool = Executors.newFixedThreadPool(<span class="number">5</span>);</span><br><span class="line">        <span class="keyword">for</span> (Integer cateId : CategoryMap.getCategoryIds()) &#123;</span><br><span class="line">            fixedThreadPool.execute<span class="function"><span class="params">(() -&gt; &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">                SearchRequest request = <span class="keyword">new</span> SearchRequest(cateId, year, month);</span></span></span><br><span class="line"><span class="function"><span class="params">                <span class="keyword">while</span> (request.hasNext()) &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">                    <span class="keyword">try</span> &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">                        MongodbDao.insert(out, request.next().getResult());</span></span></span><br><span class="line"><span class="function"><span class="params">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span></span></span><br><span class="line"><span class="function"><span class="params">                        log.error(<span class="string">"获取数据失败:"</span> + request.getLongURL(), e);</span></span></span><br><span class="line"><span class="function"><span class="params">                    &#125;</span></span></span><br><span class="line"><span class="function"><span class="params">                &#125;</span></span></span><br><span class="line"><span class="function"><span class="params">                log.info(<span class="string">"&#123;&#125;的视频已处理完成"</span>, getCategoryName(cateId));</span></span></span><br><span class="line"><span class="function"><span class="params">            &#125;)</span>;</span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">        <span class="title">fixedThreadPool</span>.<span class="title">shutdown</span><span class="params">()</span>;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">        <span class="title">try</span> &#123;</span></span><br><span class="line"><span class="function">            <span class="title">fixedThreadPool</span>.<span class="title">awaitTermination</span><span class="params">(Long.MAX_VALUE, TimeUnit.MINUTES)</span>;</span></span><br><span class="line"><span class="function">            <span class="title">log</span>.<span class="title">info</span><span class="params">(<span class="string">"&#123;&#125;-&#123;&#125;视频数据已全部插入到&#123;&#125;"</span>, year, month, out)</span>;</span></span><br><span class="line"><span class="function">        &#125; <span class="title">catch</span> <span class="params">(InterruptedException e)</span> &#123;</span></span><br><span class="line"><span class="function">            <span class="title">log</span>.<span class="title">error</span><span class="params">(<span class="string">""</span>, e)</span>;</span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br></pre></td></tr></table></figure>
<p>把search接口封装成一个请求类 ,并提供便捷的访问方法</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> class SearchRequest &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> API_URL = <span class="string">"https://s.search.bilibili.com/cate/search"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> ORDER_CLICK = <span class="string">"click"</span>;<span class="comment">// 点击</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> ORDER_STOW = <span class="string">"stow"</span>;<span class="comment">// 收藏</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> ORDER_SCORES = <span class="string">"scores"</span>;<span class="comment">// 评分</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> ORDER_DM = <span class="string">"dm"</span>;<span class="comment">// 弹幕</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">String</span> ORDER_COIN = <span class="string">"coin"</span>;<span class="comment">// 硬币</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Integer COPYRIGHT_ALL = <span class="number">-1</span>;<span class="comment">// 全部</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Integer COPYRIGHT_OWN = <span class="number">1</span>;<span class="comment">// 原创</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">String</span> main_ver = <span class="string">"v3"</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">String</span> search_type = <span class="string">"video"</span>;</span><br><span class="line">    <span class="keyword">String</span> view_type = <span class="string">"hot_rank"</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">String</span> pic_size = <span class="string">"160x100"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">String</span> order = ORDER_CLICK;</span><br><span class="line">    Integer copy_right = COPYRIGHT_ALL;</span><br><span class="line"></span><br><span class="line">    Integer page = <span class="number">0</span>;</span><br><span class="line">    Integer pagesize = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    Integer cate_id;</span><br><span class="line">    <span class="keyword">String</span> time_from;</span><br><span class="line">    <span class="keyword">String</span> time_to;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Boolean nextFlag = <span class="keyword">true</span>;</span><br><span class="line">    @Getter</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> longURL;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*---------------------------------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> SearchRequest(Integer cate_id, <span class="keyword">String</span> time_from, <span class="keyword">String</span> time_to) &#123;</span><br><span class="line">        <span class="keyword">this</span>.cate_id = cate_id;</span><br><span class="line">        <span class="keyword">this</span>.time_from = time_from;</span><br><span class="line">        <span class="keyword">this</span>.time_to = time_to;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> SearchRequest(Integer cate_id, Integer <span class="built_in">year</span>, Integer <span class="built_in">month</span>) &#123;</span><br><span class="line">        <span class="keyword">String</span>[] dateRange = DateTools.getDateRangeYYYYMMDD(<span class="built_in">year</span>, <span class="built_in">month</span>);</span><br><span class="line">        <span class="keyword">this</span>.cate_id = cate_id;</span><br><span class="line">        <span class="keyword">this</span>.time_from = dateRange[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">this</span>.time_to = dateRange[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*---------------------------------------------------------------------------------*/</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Boolean hasNext() &#123;</span><br><span class="line">        <span class="keyword">return</span> nextFlag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> SearchResponse next() <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        SearchResponse res = <span class="built_in">get</span>(<span class="keyword">this</span>.page + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (res.numPages == <span class="number">0</span> || res.numPages.equals(page)) &#123;</span><br><span class="line">            nextFlag = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> SearchResponse <span class="built_in">get</span>(Integer page) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">if</span> (page &lt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> KnownException(<span class="string">"page must &gt; 0"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.page = page;</span><br><span class="line">        <span class="keyword">return</span> response(<span class="built_in">get</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> <span class="built_in">get</span>() <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        longURL = API_URL + <span class="string">"?"</span> + getParam4URL();</span><br><span class="line">        <span class="keyword">return</span> HttpTools.getInstance().<span class="built_in">get</span>(longURL);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">String</span> getParam4URL() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StringBuilder()</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"main_ver"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(main_ver).<span class="built_in">append</span>(<span class="string">"&amp;amp;"</span>)</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"search_type"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(search_type).<span class="built_in">append</span>(<span class="string">"&amp;amp;"</span>)</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"view_type"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(view_type).<span class="built_in">append</span>(<span class="string">"&amp;amp;"</span>)</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"pic_size"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(pic_size).<span class="built_in">append</span>(<span class="string">"&amp;amp;"</span>)</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"order"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(order).<span class="built_in">append</span>(<span class="string">"&amp;amp;"</span>)</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"copy_right"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(copy_right).<span class="built_in">append</span>(<span class="string">"&amp;amp;"</span>)</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"cate_id"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(cate_id).<span class="built_in">append</span>(<span class="string">"&amp;amp;"</span>)</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"page"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(page).<span class="built_in">append</span>(<span class="string">"&amp;amp;"</span>)</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"pagesize"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(pagesize).<span class="built_in">append</span>(<span class="string">"&amp;amp;"</span>)</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"time_from"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(time_from).<span class="built_in">append</span>(<span class="string">"&amp;amp;"</span>)</span><br><span class="line">                .<span class="built_in">append</span>(<span class="string">"time_to"</span>).<span class="built_in">append</span>(<span class="string">"="</span>).<span class="built_in">append</span>(time_to)</span><br><span class="line">                .toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> SearchResponse response(<span class="keyword">String</span> json) &#123;</span><br><span class="line">        SearchResponse searchResponse = JSON.parseObject(json, SearchResponse.class);</span><br><span class="line">        <span class="keyword">if</span> (searchResponse.code != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> KnownException(<span class="string">"返回Code错误:"</span> + searchResponse.code);</span><br><span class="line">        &#125;</span><br><span class="line">        searchResponse.setJson(json);</span><br><span class="line">        searchResponse.getResult().forEach(<span class="built_in">map</span> -&gt; <span class="built_in">map</span>.put(<span class="string">"cateid"</span>, cate_id));</span><br><span class="line">        <span class="keyword">return</span> searchResponse;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img alt="这里写图片描述" src="http://img.blog.csdn.net/20170928144825361?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMTg1ODQwNQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" title=""></p>
<h3 id="Analysis分析"><a href="#Analysis分析" class="headerlink" title="Analysis分析"></a>Analysis分析</h3><p>使用hadoop任务分析视频的tag出现频率</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">TagSplit</span> <span class="keyword">extends</span> <span class="title">AbstractMongoAnalysis</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    public void configMapperReducer(<span class="type">HadoopJobBuilder</span> builder) <span class="keyword">throws</span> <span class="type">IOException</span> &#123;</span><br><span class="line">        builder.addMapper(<span class="type">SpliterMapper</span>.<span class="keyword">class</span>)</span><br><span class="line">                .setReducer(<span class="type">TextSumReducer</span>.<span class="keyword">class</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static <span class="class"><span class="keyword">class</span> <span class="title">SpliterMapper</span> <span class="keyword">extends</span> <span class="title">Mapper&lt;Object</span>, <span class="title">BSONObject</span>, <span class="title">Text</span>, <span class="title">IntWritable&gt;</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> static <span class="keyword">final</span> <span class="type">IntWritable</span> one = <span class="keyword">new</span> <span class="type">IntWritable</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">private</span> <span class="type">Text</span> word = <span class="keyword">new</span> <span class="type">Text</span>();</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        public void map(<span class="type">Object</span> key, <span class="type">BSONObject</span> value, <span class="type">Context</span> context)</span><br><span class="line">                <span class="keyword">throws</span> <span class="type">IOException</span>, <span class="type">InterruptedException</span> &#123;</span><br><span class="line">            <span class="type">String</span> tags = (<span class="type">String</span>) value.get(<span class="string">"tag"</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">String</span> s : tags.split(<span class="string">","</span>)) &#123;</span><br><span class="line">                word.set(s);</span><br><span class="line">                context.write(word, one);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Analysis任务类中主要是对Map/Reduce类进行定义和添加 ;将其他操作都封装在了AbstractMongoAnalysis中 ,包括设置input/output format</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@Slf4j</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title">AbstractMongoAnalysis</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 任务实现类配置Mapper和Reducer的入口</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configMapperReducer</span>(<span class="params">HadoopJobBuilder builder</span>) throws IOException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取in/out集合 ,根据analysis的配置执行一系列操作</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span>(<span class="params">String <span class="keyword">in</span>, String <span class="keyword">out</span></span>) </span>&#123;</span><br><span class="line">        Preconditions.checkNotNull(<span class="keyword">in</span>, <span class="keyword">out</span>);</span><br><span class="line">        MongodbDao.drop(<span class="keyword">out</span>);<span class="comment">//删除之前的结果表</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            HadoopJobBuilder builder = <span class="keyword">new</span> HadoopJobBuilder();</span><br><span class="line">            builder.config(mongoConfig(<span class="keyword">in</span>, <span class="keyword">out</span>), JobEnum.mongodb);<span class="comment">//自动注入mongo+hadoop相关配置</span></span><br><span class="line">            configMapperReducer(builder);<span class="comment">//注入mapper/reducer</span></span><br><span class="line">            builder.build().waitForCompletion(<span class="literal">true</span>);<span class="comment">//运行</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">""</span>, e);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> KnownException(<span class="string">"任务创建失败:"</span>, e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">""</span>, e);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> KnownException(<span class="string">"任务执行失败:"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>HadoopJobBuilder是我写的一个Buider类 ,方便配置</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HadoopJobBuilder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Job job;<span class="comment">//hadoop任务</span></span><br><span class="line">    <span class="keyword">private</span> Configuration conf;<span class="comment">//当前任务的配置</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> HadoopJobBuilder config(Configuration conf, JobEnum jobEnum) throws IOException &#123;</span><br><span class="line">        <span class="keyword">this</span>.conf = conf;</span><br><span class="line">        <span class="keyword">this</span>.job = getInstance(conf, jobEnum.name());</span><br><span class="line">        job.setJarByClass(<span class="keyword">this</span>.getClass());</span><br><span class="line">        switch (jobEnum) &#123;</span><br><span class="line">            case mongodb:</span><br><span class="line">                <span class="keyword">return</span> initMongo();</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果是mongodb</span></span><br><span class="line">    <span class="keyword">private</span> HadoopJobBuilder initMongo() throws IOException &#123;</span><br><span class="line">        job.setInputFormatClass(MongoInputFormat.<span class="keyword">class</span>);</span><br><span class="line">        job.setOutputFormatClass(MongoOutputFormat.<span class="keyword">class</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> HadoopJobBuilder addMapper(Class&lt;? extends Mapper&gt; mapperClass) throws IOException &#123;</span><br><span class="line">        HadoopTools.addMapper(job, mapperClass, conf);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> HadoopJobBuilder setReducer(Class&lt;? extends Reducer&gt; reducerClass) &#123;</span><br><span class="line">        HadoopTools.setReducer(job, reducerClass, conf);</span><br><span class="line">        <span class="comment">//job.setCombinerClass(reducerClass);</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> HadoopJobBuilder afterReducer(Class&lt;? extends Mapper&gt; mapperClass) throws IOException &#123;</span><br><span class="line">        HadoopTools.afterReducer(job, mapperClass, conf);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Job build() &#123;</span><br><span class="line">        <span class="keyword">return</span> job;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h4><p>如果出现<code>IOException in org.apache.hadoop.io.nativeio.NativeIO access(String path, AccessRight desiredAccess)</code> ,应该是hadoop在Windows环境下操作文件的权限不通过 , 可以把NativeIO .java复制出来(同路径) ,修改这一段代码然后运行即可 (会自动覆盖hadoop包中的class)</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> access(String path, AccessRight desiredAccess)</span><br><span class="line">                <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="comment">//return access0(path, desiredAccess.accessRight());</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><p>数据分析才刚刚开始 .(游戏占据半壁江山啊 : ) <br><br><img alt="这里写图片描述" src="http://img.blog.csdn.net/20170928150542071?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvdTAxMTg1ODQwNQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" title=""></p>
<p>不过作为一个程序猿 ,做数据分析的瓶颈更多在主题上 ,’我应该分析啥”这些数据能得出啥”我的数据有什么意义’,代码只需要逻辑表达而已 .</p>
<h3 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h3><ul>
<li>更多的分析</li>
<li>图形化展示</li>
<li>更多数据</li>
<li>Hadoop的其他组件</li>
</ul>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2017-09-28</span><i class="fa fa-tag"></i></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,https://anddd7.github.io/legacy/MongoDB+Hadoop/,Anddd7's Planet,数据分析 起步 (一) MongoDB+Hadoop,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/legacy/Python Crawler/" title="Python爬虫应用:迁移CSDN博客+抓取Linux公社资料">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/legacy/Spring AOP/" title="Spring AOP造成的@Controller注册失败">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>